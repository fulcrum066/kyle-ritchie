rule Detecting_satana{
    meta:
        description = "This rule is used to detect the satana ransomware"
        author = "Kyle Ritchie"
        date = "15/3/25"

    strings:
        $mz_hex = "{ 4D 5A }"
        $pdbFile = "lbetwmwy\uijeuqplfwub.pdb"
        $MD5 = "MD5"
        $USER32_Function = "MessageBoxA" //Could be used to display message to user
        $SATANA = "!SATANA!"
        $EMAIL = "E-mail found: "
        $Reg_Functions = "reg"
        $XOR = "XOR"

    condition:
        pe.imports("KERNEL32.dll")
        pe.imports("ntdll.dll") //Apparently a common library in malwares 
        pe.imports("MSVCRT.dll") //Used for programs written with C libraries
        pe.imports("mpr.dll") //Used for networking 
        pe.imports("ADVAPI32.dll") //used in addition to kernal for more advanced function
        pe.imports("SHELL32.dll")
    
}